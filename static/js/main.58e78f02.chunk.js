(this.webpackJsonpgomoku=this.webpackJsonpgomoku||[]).push([[0],{113:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),o=t(9),c=t.n(o),i=(t(89),t(53)),u=t(140),l=t(142),d=t(151),s=t(152),p=t(154),m=t(145),g=t(146),f=t(147),b=t(150),y=t(148),E=t(28),I="gomoku/SIGN_UP",S="gomoku/SIGN_UP_SUCCESS",h="gomoku/SIGN_UP_FAILURE",v="gomoku/LOG_IN",O="gomoku/LOG_IN_SUCCESS",j="gomoku/LOG_IN_FAILURE",k="gomoku/START_GAME",C="gomoku/START_GAME_SUCCESS",U="gomoku/START_GAME_FAILURE",_="gomoku/END_GAME",A="gomoku/END_GAME_SUCCESS",x="gomoku/END_GAME_FAILURE",w="gomoku/RESTART_GAME",G="gomoku/RESTART_GAME_SUCCESS",R="gomoku/RESTART_GAME_FAILURE",T="gomoku/REQUEST_UPDATE",N="gomoku/REQUEST_UPDATE_SUCCESS",M="gomoku/REQUEST_UPDATE_FAILURE",D="gomoku/PLAY_MOVE",L=function(e){return{type:I,payload:e}},P=function(e){return{type:A,payload:e}},F=function(e){return{type:T,payload:e}},B=function(e){return{type:N,payload:e}},z=function(e){return{type:M,payload:e}},Q=t(38),W=function(e){return e.game},q=Object(Q.a)((function(e){return e.player}),(function(e){return e.playerId})),J=Object(Q.a)(W,(function(e){return e.id})),V=(Object(Q.a)(W,(function(e){return e.loading})),Object(Q.a)((function(e){return e.board}),(function(e){return e.board}))),Y=Object(Q.a)(W,(function(e){return e.isOwner})),$=t(13),H=Object(u.a)((function(e){return{layout:{paddingTop:e.spacing(6)}}})),K={startGame:function(e){return{type:k,payload:e}}},X=Object(E.b)((function(e){return{gameId:J(e)}}),K)((function(e){var a=Object(n.useState)(!1),t=Object(i.a)(a,2),o=t[0],c=t[1],u=Object(n.useState)(""),E=Object(i.a)(u,2),I=E[0],S=E[1],h=H(),v=function(){c(!1),S("")};return e.gameId?r.a.createElement($.a,{to:"/game"}):r.a.createElement(l.a,{className:h.layout},r.a.createElement(d.a,{display:"flex",justifyContent:"center"},r.a.createElement(s.a,{variant:"contained",onClick:function(){return c(!0)}},"Enter game ID"),r.a.createElement(s.a,{variant:"contained",color:"secondary",onClick:function(){return e.startGame()}},"Start a new game")),r.a.createElement(p.a,{open:o,onClose:v},r.a.createElement(m.a,null,"Enter an existing game"),r.a.createElement(g.a,null,r.a.createElement(f.a,null,"Please enter the game ID for the existing game."),r.a.createElement(b.a,{autoFocus:!0,margin:"dense",id:"gameId",label:"Game ID",type:"text",fullWidth:!0,value:I,onChange:function(e){return S(e.target.value)}})),r.a.createElement(y.a,null,r.a.createElement(s.a,{onClick:v},"Cancel"),r.a.createElement(s.a,{onClick:function(){e.startGame({gameId:I}),v()},color:"secondary"},"Enter game"))))})),Z=t(44),ee=t(149),ae=t(144),te=t(72),ne=["#000","#fff"],re=Object(u.a)((function(e){return{layout:{marginTop:e.spacing(6)},boardContainer:{position:"relative"},arenaTable:{border:"1px solid #444",borderCollapse:"collapse",boxSizing:"border-box"},cell:{width:"".concat(28,"px"),height:"".concat(28,"px"),border:"1px solid #444",boxSizing:"border-box",backgroundColor:"rgb(241, 236, 211)"},spot:{display:"inline-block",position:"absolute",borderRadius:"50%",boxSizing:"border-box",cursor:"pointer",width:"".concat(14,"px"),height:"".concat(14,"px"),border:"1px solid transparent"},wrapper:{padding:e.spacing(2),marginBottom:e.spacing(1)},actions:{"& > *":{margin:e.spacing(.5)}}}})),oe={requestUpdate:F,playMove:function(e){return{type:D,payload:e}},restartGame:function(e){return{type:w,payload:e}},endGame:function(e){return{type:_,payload:e}}},ce=Object(E.b)((function(e){return{gameId:J(e),playerId:q(e),isOwner:Y(e),board:V(e)}}),oe)((function(e){var a=e.gameId,t=e.requestUpdate,o=e.restartGame,c=e.playMove,i=e.endGame,u=e.board,p=e.playerId,m=e.isOwner,g=re();Object(n.useEffect)((function(){if(a){t({gameId:a});var e=setInterval((function(){t({gameId:a})}),1e3);return function(){return clearInterval(e)}}}),[a,t]);var f=Object(n.useCallback)((function(){m&&o({gameId:a})}),[m,a,o]),b=Object(n.useCallback)((function(){m&&i({gameId:a})}),[m,a,i]);if(!a)return r.a.createElement($.a,{to:"/"});for(var y=u.length,E=(u[0]||[]).length,I=[],S=0;S<=y;++S){for(var h=[],v=0;v<=E;++v)h.push(r.a.createElement("td",{key:v,className:g.cell}));I.push(r.a.createElement("tr",{key:S},h))}return r.a.createElement(l.a,{className:g.layout},r.a.createElement(ee.a,{container:!0},r.a.createElement(ee.a,{item:!0,md:8},r.a.createElement(d.a,{display:"flex",justifyContent:"center"},r.a.createElement("div",{className:g.boardContainer},r.a.createElement("div",null,u.map((function(e,t){return e.map((function(e,n){return r.a.createElement("span",{key:"".concat(n,",").concat(t),className:g.spot,style:{top:"".concat(28*(t+1)-7,"px"),left:"".concat(28*(n+1)-7,"px"),backgroundColor:ne[e],borderColor:[0,1].includes(e)?"#555":"transparent"},onClick:function(){return function(e,t){c({gameId:a,playerId:p,x:e,y:t})}(n,t)}})}))}))),r.a.createElement("table",{className:g.arenaTable},r.a.createElement("tbody",null,I))))),r.a.createElement(ee.a,{item:!0,md:4},r.a.createElement(ae.a,{className:g.wrapper},r.a.createElement(te.a,{variant:"h6"},"Info"),r.a.createElement("br",null),r.a.createElement(te.a,{variant:"body1"},"ID: ",a)),r.a.createElement(ae.a,{className:g.wrapper},r.a.createElement(te.a,{variant:"h6"},"Actions"),r.a.createElement("br",null),r.a.createElement("div",{className:g.actions},r.a.createElement(s.a,{variant:"contained",disabled:!m,onClick:f},"Restart"),r.a.createElement(s.a,{variant:"contained",color:"secondary",disabled:!m,onClick:b},"End game"))))))}));var ie={logIn:function(e){return{type:v,payload:e}}},ue=Object(E.b)((function(e){return{playerId:q(e)}}),ie)((function(e){var a=e.logIn,t=e.playerId;return Object(n.useEffect)((function(){t||a()}),[t,a]),r.a.createElement(Z.a,{basename:"/rabbit-and-pig-gomoku"},r.a.createElement($.d,null,r.a.createElement($.b,{path:"/game"},r.a.createElement(ce,null)),r.a.createElement($.b,{path:"/"},r.a.createElement(X,null))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le,de=t(25),se=t(10),pe={id:null,loading:!1,isOwner:!1},me={board:[],loading:!1,errorMessage:null},ge={playerId:null,loading:!1},fe=Object(de.c)({game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload,r=void 0===n?{}:n;switch(t){case k:return Object(se.a)(Object(se.a)({},e),{},{id:null,loading:!0,isOwner:!Boolean(r.gameId)});case C:return Object(se.a)(Object(se.a)({},e),{},{id:r.id,playerId:r.playerId,loading:!1});case A:case U:return Object(se.a)(Object(se.a)({},e),{},{id:null,loading:!1,isOwner:!1})}return Object(se.a)({},e)},board:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case T:return Object(se.a)(Object(se.a)({},e),{},{loading:!0});case N:var r=n.updates.filter((function(e){return["board","move"].includes(e.type)}));if(0===r.length)break;var o=e.board.map((function(e){return e.slice()})),c=r.reduce((function(e,a){return"board"===a.type?a.board:("move"===a.type&&(e[a.y][a.x]=a.value),e)}),o);return Object(se.a)(Object(se.a)({},e),{},{loading:!1,board:c});case M:return Object(se.a)(Object(se.a)({},e),{},{loading:!1,errorMessage:n.message})}return Object(se.a)({},e)},player:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case I:return Object(se.a)(Object(se.a)({},e),{},{loading:!0});case O:case S:return Object(se.a)(Object(se.a)({},e),{},{loading:!1,playerId:n.userId});case h:return Object(se.a)(Object(se.a)({},e),{},{loading:!1})}return Object(se.a)({},e)}}),be=t(22),ye=t(43),Ee=t.n(ye),Ie=function(e){return"".concat("https://rabbit-and-pig.herokuapp.com").concat(e)},Se=function(e){return a=Ie(e),Ee.a.get(a);var a},he=function(e,a){return function(e,a){return Ee.a.post(e,a)}(Ie(e),a)},ve=function(e,a){return function(e,a){return Ee.a.put(e,a)}(Ie(e),a)},Oe=function(e){return a=Ie(e),Ee.a.delete(a);var a},je=function(e,a){var t=q(e.getState());return new URLSearchParams(Object(se.a)({userId:t},a))},ke=(le={},Object(be.a)(le,I,(function(e){he("/signup").then((function(a){var t,n,r=a.data;t=r.userId,sessionStorage.setItem("playerId",t),"SUCCESS"===r.code?e.dispatch((n={userId:r.userId},{type:S,payload:n})):e.dispatch(function(e){return{type:h,payload:e}}(r))}))})),Object(be.a)(le,v,(function(e){var a=sessionStorage.getItem("playerId");if(!a)return e.dispatch(L());var t=new URLSearchParams({userId:a});he("/login?".concat(t.toString())).then((function(a){var t,n=a.data;if("SUCCESS"===n.code)return e.dispatch((t={userId:n.userId},{type:O,payload:t}));e.dispatch(function(e){return{type:j,payload:e}}(n)),sessionStorage.removeItem("playerId"),e.dispatch(L())}))})),Object(be.a)(le,k,(function(e,a){var t=a.payload,n=(void 0===t?{}:t).gameId,r=je(e,n?{gameId:n}:{});he("/game/gomoku/start?".concat(r.toString())).then((function(a){var t=a.data;"SUCCESS"===t.code?e.dispatch(function(e){return{type:C,payload:e}}(t)):e.dispatch(function(e){return{type:U,payload:e}}(t))}))})),Object(be.a)(le,w,(function(e,a){var t=a.payload.gameId,n=je(e,{gameId:t});ve("/game/gomoku/restart?".concat(n.toString())).then((function(a){var n=a.data;"SUCCESS"===n.code?(e.dispatch(function(e){return{type:G,payload:e}}()),e.dispatch(F({gameId:t}))):e.dispatch(function(e){return{type:R,payload:e}}(n))}))})),Object(be.a)(le,T,(function(e,a){var t=a.payload,n=je(e,{gameId:t.gameId});Se("/game/gomoku/update?".concat(n.toString())).then((function(a){var t=a.data,n=t.code,r=t.message,o=t.updates;"SUCCESS"===n?o&&e.dispatch(B({updates:o})):"GAME_ENDED"===n?e.dispatch(P()):e.dispatch(z({code:n,message:r}))}))})),Object(be.a)(le,D,(function(e,a){var t=a.payload,n=t.gameId,r=t.playerId,o=t.x,c=t.y,i=je(e,{gameId:n,x:o,y:c});ve("/game/gomoku/play?".concat(i.toString()),{playerId:r,x:o,y:c}).then((function(a){var t=a.data,n=t.code,r=t.message,o=t.updates;"SUCCESS"===n?e.dispatch(B({updates:o})):e.dispatch(z({code:n,message:r}))}))})),Object(be.a)(le,_,(function(e,a){var t=a.payload.gameId,n=je(e,{gameId:t});Oe("/game/gomoku/end?".concat(n.toString())).then((function(a){"SUCCESS"===a.data.code?e.dispatch(P()):e.dispatch(function(e){return{type:x,payload:e}}())}))})),le),Ce=function(e){return function(a){return function(t){ke[t.type]&&ke[t.type](e,t),a(t)}}},Ue=function(){var e=[Ce],a=de.d;return Object(de.e)(fe,a(de.a.apply(void 0,e)))}();c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(E.a,{store:Ue},r.a.createElement(ue,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},84:function(e,a,t){e.exports=t(113)},89:function(e,a,t){}},[[84,1,2]]]);
//# sourceMappingURL=main.58e78f02.chunk.js.map